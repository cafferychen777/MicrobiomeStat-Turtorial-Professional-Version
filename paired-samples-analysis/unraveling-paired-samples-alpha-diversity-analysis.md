---
description: >-
  An introduction to exploring alpha diversity indices in a paired sample
  setting, highlighting species complexity within paired samples.
---

# Unraveling Paired Samples: Alpha Diversity Analysis

Prepare for an insightful journey into **Unraveling Paired Samples: Alpha Diversity Analysis**! We'll traverse through the diverse landscape of **alpha diversity**, examining variations across **different time points** and **groups**. Through the lens of **illustrative boxplots**, we'll probe into the existence of significant **changes or disparities** in alpha diversity. Additionally, we're set to explore if there are **transformations** in alpha diversity within the **same group across two time points**. So, let's dive in and witness the dynamic fluctuations within the microscopic world of microbiomes!

A quick note before we proceed further with our **alpha diversity analysis**. In the MicrobiomeStat toolbox, the functions ending in '**single**' are versatile and adaptable, capable of handling **single time point designs**, a **specific time point in paired samples designs**, or a **particular time point in longitudinal study designs**. Functions with the suffix '**pair**' are specifically tailored for **paired samples designs**, and those concluding with '**long**' are applicable to both **paired and multiple time point scenarios**. However, bear in mind, certain **visualizations may not appear aesthetically pleasing or insightful when applied to a paired samples design**. As we explore `generate_alpha_change_boxplot_pair` and `generate_alpha_boxplot_long`, this distinction will become clearer!

Delving into our alpha diversity analysis, we first employ the `generate_alpha_boxplot_long` function:

```r
generate_alpha_boxplot_long(
  data.obj = peerj32.obj,
  alpha.obj = NULL,
  alpha.name = c("simpson"),
  subject.var = "subject",
  time.var = "time",
  t0.level = "1",
  ts.levels = "2",
  group.var = "group",
  strata.var = NULL,
  base.size = 20,
  theme.choice = "bw",
  palette = NULL,
  pdf = TRUE,
  file.ann = NULL,
  pdf.wid = 11,
  pdf.hei = 8.5
)
```

<figure><img src="../.gitbook/assets/Screenshot 2023-06-12 at 14.35.00.png" alt=""><figcaption><p>This boxplot, crafted by <strong>generate_alpha_boxplot_long()</strong>, showcases the Simpson diversity index across multiple time points for each group. The connecting lines represent individual subjects over time, intuitively visualizing each subject's alpha diversity change.</p></figcaption></figure>

This function produces an **informative alpha diversity boxplot**. Should you choose not to provide an **alpha.obj**, the function will conveniently call **mStat\_calculate\_alpha\_diversity** to do the calculations for you. What's particularly striking about this plot is the **lines linking the boxplots**; these lines represent the same subject across different time points. This provides an immediate visual of how **individual subjects' alpha diversity changes over time**. Please note that if you have more thRan **10 time points or more than 25 subjects**, the connecting lines will automatically be adjusted to represent the **average alpha diversity index within the same time point**, ensuring the plot remains clear and interpretable.

Diving deeper, we now explore the **generate\_alpha\_change\_boxplot\_pair()** function. Take a look at the sample code below:

```r
generate_alpha_change_boxplot_pair(
   data.obj = peerj32.obj,
   alpha.obj = NULL,
   alpha.name = c("simpson"),
   subject.var = "subject",
   time.var = "time",
   group.var = "group",
   strata.var = NULL,
   change.base = "1",
   change.func = "lfc",
   base.size = 20,
   theme.choice = "bw",
   palette = NULL,
   pdf = TRUE,
   file.ann = "test",
   pdf.wid = 11,
   pdf.hei = 8.5
)
```

<figure><img src="../.gitbook/assets/Screenshot 2023-06-12 at 14.53.57.png" alt=""><figcaption><p>This boxplot, generated by <strong>generate_alpha_change_boxplot_pair()</strong>, illustrates the log 2 fold change in alpha diversity between groups. The connecting lines highlight the changes for individual subjects, providing an intuitive view of group differences.</p></figcaption></figure>

This powerful tool is designed to **visualize shifts in alpha diversity**. With this function, **complex data** transforms into an easily **digestible format**, allowing you to swiftly pinpoint significant disparities between **two groups' alpha diversity changes**. This tool comes equipped with the **change.func** parameter, offering options of 'difference', 'lfc', or even a custom function, tailored to your needs. 'Difference' depicts **absolute alteration**, while 'lfc' signifies **log 2 fold change**. Just as before, should an **alpha.obj** not be provided, the function steps in to calculate.

{% hint style="info" %}
**Hint**: You can **create your own `change.func`** to customize how the change in alpha diversity is calculated between two time points. Here's an example of how you can do it:

```r
# Define custom function
change_ratio <- function(time_2, time_1) {
  return(time_2 / time_1)
}
```

In this case, the function `change_ratio` is defined to calculate the **ratio** of alpha diversity at `time_2` to `time_1`. You can then use `change_ratio` as your `change.func` in the `generate_alpha_change_boxplot_pair()` function. This will result in the plot showing the **fold-change** in alpha diversity for each subject across the two time points.
{% endhint %}
